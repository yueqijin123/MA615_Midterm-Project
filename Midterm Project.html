<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yueqi (Charlene) Jin">
<meta name="dcterms.date" content="2023-11-01">

<title>MA615 Midterm Project-Flood Analysis in 2020-2021</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Midterm Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Midterm Project_files/libs/quarto-html/quarto.js"></script>
<script src="Midterm Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Midterm Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Midterm Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Midterm Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Midterm Project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Midterm Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Midterm Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Midterm Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MA615 Midterm Project-Flood Analysis in 2020-2021</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yueqi (Charlene) Jin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 1, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the United States, the period of 2020-2021 saw a notable incidence of various disasters, with floods emerging as one of the leading causes of fatalities and injuries, ranking second overall. This underlines the significant threat posed by flooding, which affected numerous states across the country. To address this issue, a detailed analysis was conducted focusing on the top 10 states with the highest frequency of floods, identifying areas in dire need of assistance.</p>
<p>Furthermore, floods were identified as one of the primary contributors to property damage in this period, emphasizing the extensive financial impact of these natural disasters.</p>
<p>A key aspect of the research involved comparing the scale and frequency of floods in 2020 and 2021. An observed increase in these parameters led to an investigation into the causes of flooding. Factors such as storm paths, increasing annual rainfall intensity in U.S, and the likelihood of floods in various states due to heavy rains were explored. The accelerated rate of water flow, often resulting from intense rainfall, was noted as a significant factor contributing to the high potential for flooding and the resultant increase in fatalities.</p>
<p>This comprehensive approach aimed to provide the necessary data to facilitate effective planning and response strategies to mitigate the impact of floods in the United States.</p>
</section>
<section id="database-acquisition-and-assessment" class="level1">
<h1>Database Acquisition and Assessment</h1>
<section id="noaa-storm-events-database" class="level2">
<h2 class="anchored" data-anchor-id="noaa-storm-events-database"><strong>1. NOAA Storm Events Database</strong>&nbsp;</h2>
<section id="where-does-the-data-come-from" class="level3">
<h3 class="anchored" data-anchor-id="where-does-the-data-come-from"><strong>1.1 Where does the data come from?</strong></h3>
<p>The National Oceanic and Atmospheric Administration (NOAA) gathers storm data primarily from the National Weather Service (NWS), which in turn collects information from various sources. These include emergency management officials at different governmental levels, local law enforcement, skywarn spotters, NWS damage assessments, media reports, the insurance sector, and the public.</p>
<p>Compiling, verifying, and processing this post-storm data takes considerable time. As a result, the National Centers for Environmental Information (NCEI) typically receives these data from the NWS about 75 days following the closure of a reporting month. For example, data from January is generally available around mid-April. The process involves the NWS offices submitting their reports to the NWS Headquarters in Silver Spring, MD, within a 60-day period. After collecting data from its 123 forecast offices, the NWS Headquarters forwards this consolidated database to the NCEI. The NCEI then takes approximately 75 days post-month-end to update the Storm Events Database and prepare publications and archives, completing this task within 75 to 90 days after a month’s end.</p>
</section>
</section>
<section id="open-fema-datasets" class="level2">
<h2 class="anchored" data-anchor-id="open-fema-datasets"><strong>2.Open FEMA Datasets</strong>&nbsp;</h2>
<section id="where-does-fema-disaster-declarations-summary-come-from" class="level3">
<h3 class="anchored" data-anchor-id="where-does-fema-disaster-declarations-summary-come-from"><strong>2.1 Where does FEMA Disaster Declarations Summary come from?</strong></h3>
<p>FEMA Disaster Declarations Summary is a summarized dataset describing all federally declared disasters. This dataset lists all official FEMA Disaster Declarations, beginning with the first disaster declaration in 1953 and features all three disaster declaration types: major disaster, emergency, and fire management assistance. The dataset includes declared recovery programs and geographic areas (county not available before 1964; Fire Management records are considered partial due to historical nature of the dataset).</p>
<p>This is raw, unedited data from FEMA’s National Emergency Management Information System (NEMIS) and as such is subject to a small percentage of human error.&nbsp;</p>
</section>
<section id="where-does-fema-web-disaster-summaries-come-from" class="level3">
<h3 class="anchored" data-anchor-id="where-does-fema-web-disaster-summaries-come-from"><strong>2.2 Where does FEMA Web Disaster Summaries come from?</strong></h3>
<p>This data set contains financial assistance values, including the number of approved applications, as well as individual, public assistance, and hazard mitigation grant amounts.</p>
</section>
<section id="data-field-description" class="level3">
<h3 class="anchored" data-anchor-id="data-field-description"><strong>2.3 Data Field Description</strong></h3>
<table class="table">
<thead>
<tr class="header">
<th>Field Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>disasterNumber</td>
<td>Sequentially assigned number used to designate an event or incident declared as a disaster.</td>
</tr>
<tr class="even">
<td>ihProgramDeclared</td>
<td>Indicates whether the Individuals and Households program was declared for this disaster. For more information on the program, please visit <a href="https://www.fema.gov">FEMA’s website</a>.</td>
</tr>
<tr class="odd">
<td>iaProgramDeclared</td>
<td>Indicates whether the Individual Assistance program was declared for this disaster. For more information on the program, please visit <a href="https://www.fema.gov">FEMA’s website</a>.</td>
</tr>
<tr class="even">
<td>paProgramDeclared</td>
<td>Indicates whether the Public Assistance program was declared for this disaster. For more information on the program, please visit <a href="https://www.fema.gov">FEMA’s website</a>.</td>
</tr>
<tr class="odd">
<td>hmProgramDeclared</td>
<td>Indicates whether the Hazard Mitigation program was declared for this disaster. For more information on the program, please visit <a href="https://www.fema.gov">FEMA’s website</a>.</td>
</tr>
<tr class="even">
<td>state</td>
<td>The name or phrase describing the U.S. state, district, or territory.</td>
</tr>
<tr class="odd">
<td>declarationDate</td>
<td>Date the disaster was declared.</td>
</tr>
<tr class="even">
<td>fyDeclared</td>
<td>Fiscal year in which the disaster was declared.</td>
</tr>
<tr class="odd">
<td>incidentType</td>
<td>The character code that defines this as a major disaster, fire management, or emergency declaration. For more information on incident types, please visit <a href="https://www.fema.gov">FEMA’s website</a>.</td>
</tr>
<tr class="even">
<td>title</td>
<td>Title for the disaster.</td>
</tr>
<tr class="odd">
<td>incidentBeginDate</td>
<td>Date the incident itself began.</td>
</tr>
<tr class="even">
<td>incidentEndDate</td>
<td>Date the incident itself ended.</td>
</tr>
<tr class="odd">
<td>disasterCloseOutDate</td>
<td>Date all financial transactions for all programs are completed.</td>
</tr>
<tr class="even">
<td>declaredCountyArea</td>
<td>The name or phrase describing the U.S. county that was included in the declaration.</td>
</tr>
<tr class="odd">
<td>placeCode</td>
<td>A unique code system FEMA uses internally to recognize locations that utilizes numbers ‘99’ + the 3-digit county FIPS code from the national standard FIPS PUB 6-4. This number recognizes FIPS county codes which were assigned if a disaster affects a county area.</td>
</tr>
<tr class="even">
<td>hash</td>
<td>A unique MD5 hash of the fields and values of the data row.</td>
</tr>
<tr class="odd">
<td>lastRefresh</td>
<td>Date the record was last updated in the FEMA data store.</td>
</tr>
<tr class="even">
<td>id</td>
<td>Unique ID assigned to the record.</td>
</tr>
<tr class="odd">
<td>placeCode</td>
<td>A unique code system FEMA uses internally to recognize locations that takes the numbers ‘99’ + the 3-digit county FIPS code. There are some declared locations that dont have recognized FIPS county codes in which case we assigned a unique identifier</td>
</tr>
<tr class="even">
<td>lastRefresh</td>
<td>Date the record was last updated in the API data store</td>
</tr>
<tr class="odd">
<td>hash</td>
<td>MD5 Hash of the fields and values of the record</td>
</tr>
<tr class="even">
<td>id</td>
<td>Unique ID assigned to the record</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="data-processing" class="level1">
<h1>Data Processing</h1>
<p>Downloading and reading the Data into file</p>
<section id="noaa-storm-events-database2020" class="level2">
<h2 class="anchored" data-anchor-id="noaa-storm-events-database2020"><strong>1. NOAA Storm Events Database(2020)</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_details-ftp_v1.0_d2020_c20230927.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df2020 <span class="ot">&lt;-</span> df2020 <span class="sc">%&gt;%</span> <span class="fu">select</span>(EPISODE_ID, EVENT_ID, STATE, STATE_FIPS, YEAR, EVENT_TYPE, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                    BEGIN_DATE_TIME, END_DATE_TIME, INJURIES_DIRECT, INJURIES_INDIRECT, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                    DEATHS_DIRECT, DEATHS_INDIRECT, DAMAGE_PROPERTY, DAMAGE_CROPS, FLOOD_CAUSE,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                    BEGIN_LOCATION, END_LOCATION, BEGIN_LAT, BEGIN_LON, END_LAT, END_LON,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                    EPISODE_NARRATIVE, EVENT_NARRATIVE)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>STATE <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2020<span class="sc">$</span>STATE)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>STATE <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2020<span class="sc">$</span>STATE)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>BEGIN_LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2020<span class="sc">$</span>BEGIN_LOCATION)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>BEGIN_LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2020<span class="sc">$</span>BEGIN_LOCATION)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>END_LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2020<span class="sc">$</span>END_LOCATION)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>END_LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2020<span class="sc">$</span>END_LOCATION)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>BEGIN_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">substr</span>(df2020<span class="sc">$</span>BEGIN_DATE_TIME, <span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>END_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">substr</span>(df2020<span class="sc">$</span>END_DATE_TIME, <span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>BEGIN_DATE_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(df2020<span class="sc">$</span>BEGIN_DATE_TIME, <span class="at">format =</span> <span class="st">"%Y/%m/%d"</span>), <span class="st">"%B"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>END_DATE_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(df2020<span class="sc">$</span>END_DATE_TIME, <span class="at">format =</span> <span class="st">"%Y/%m/%d"</span>), <span class="st">"%B"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>Duration_Days <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">difftime</span>(<span class="fu">as.Date</span>(df2020<span class="sc">$</span>END_DATE_TIME, <span class="at">format =</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"%Y/%m/%d"</span>),<span class="fu">as.Date</span>(df2020<span class="sc">$</span>BEGIN_DATE_TIME, <span class="at">format =</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">"%Y/%m/%d"</span>), <span class="at">units =</span> <span class="st">"days"</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>DAMAGE_PROPERTY <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"K"</span>, <span class="st">""</span>, df2020<span class="sc">$</span>DAMAGE_PROPERTY, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>df2020<span class="sc">$</span>DAMAGE_CROPS <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"K"</span>, <span class="st">""</span>, df2020<span class="sc">$</span>DAMAGE_CROPS, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2020)[<span class="fu">names</span>(df2020) <span class="sc">==</span> <span class="st">"DAMAGE_PROPERTY"</span>] <span class="ot">&lt;-</span> <span class="st">"DAMAGE_PROPERTY(K)"</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2020)[<span class="fu">names</span>(df2020) <span class="sc">==</span> <span class="st">"DAMAGE_CROPS"</span>] <span class="ot">&lt;-</span> <span class="st">"DAMAGE_CROPS(K)"</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df2020, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetails_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fatalities_df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_fatalities-ftp_v1.0_d2020_c20230927.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fatalities_df2020 <span class="ot">&lt;-</span> fatalities_df2020 <span class="sc">%&gt;%</span> <span class="fu">select</span>(FATALITY_ID, EVENT_ID, FATALITY_DATE, FATALITY_AGE, FATALITY_SEX, FATALITY_LOCATION)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>fatalities_df2020<span class="sc">$</span>FATALITY_DATE <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(fatalities_df2020<span class="sc">$</span>FATALITY_DATE, <span class="at">format=</span><span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fatalities_df2020<span class="sc">$</span>FATALITY_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(fatalities_df2020<span class="sc">$</span>FATALITY_DATE, <span class="st">"%B"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>fatalities_df2020<span class="sc">$</span>FATALITY_AGE[<span class="fu">is.na</span>(fatalities_df2020<span class="sc">$</span>FATALITY_AGE)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>fatalities_df2020<span class="sc">$</span>FATALITY_SEX[<span class="fu">is.na</span>(fatalities_df2020<span class="sc">$</span>FATALITY_SEX)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(fatalities_df2020, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormFatalities_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>locations_df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_locations-ftp_v1.0_d2020_c20230927.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>locations_df2020 <span class="ot">&lt;-</span> locations_df2020 <span class="sc">%&gt;%</span> <span class="fu">select</span>(EVENT_ID, LOCATION, LATITUDE, LONGITUDE)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>locations_df2020<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(.*?</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, locations_df2020<span class="sc">$</span>LOCATION) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>locations_df2020<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(locations_df2020<span class="sc">$</span>LOCATION)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>locations_df2020<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(locations_df2020<span class="sc">$</span>LOCATION)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(locations_df2020, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormLocations_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>details_df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetails_clean.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fatalities_df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormFatalities_clean.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>locations_df2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormLocations_clean.csv"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the data frames</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>detailsfatalities_df2020 <span class="ot">&lt;-</span> details_df2020 <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fatalities_df2020, <span class="at">by =</span> <span class="st">"EVENT_ID"</span>) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>detailslocations_df2020 <span class="ot">&lt;-</span> details_df2020 <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(locations_df2020, <span class="at">by =</span> <span class="st">"EVENT_ID"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>detailsfatalities_df2020  <span class="ot">&lt;-</span> detailsfatalities_df2020  <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR, <span class="fu">everything</span>())</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>detailslocations_df2020  <span class="ot">&lt;-</span> detailslocations_df2020  <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR, <span class="fu">everything</span>())</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the merged data frame to a new CSV file</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(detailsfatalities_df2020, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetail+Fatalities.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(detailslocations_df2020, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetail+Locations.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="noaa-storm-events-database2021" class="level2">
<h2 class="anchored" data-anchor-id="noaa-storm-events-database2021"><strong>2. NOAA Storm Events Database(2021)</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_details-ftp_v1.0_d2021_c20231017.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df2021 <span class="ot">&lt;-</span> df2021 <span class="sc">%&gt;%</span> <span class="fu">select</span>(EPISODE_ID, EVENT_ID, STATE, STATE_FIPS, YEAR, EVENT_TYPE, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                    BEGIN_DATE_TIME, END_DATE_TIME, INJURIES_DIRECT, INJURIES_INDIRECT, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                    DEATHS_DIRECT, DEATHS_INDIRECT, DAMAGE_PROPERTY, DAMAGE_CROPS, FLOOD_CAUSE,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                    BEGIN_LOCATION, END_LOCATION, BEGIN_LAT, BEGIN_LON, END_LAT, END_LON,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                    EPISODE_NARRATIVE, EVENT_NARRATIVE)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>STATE <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2021<span class="sc">$</span>STATE)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>STATE <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2021<span class="sc">$</span>STATE)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2021<span class="sc">$</span>BEGIN_LOCATION)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2021<span class="sc">$</span>BEGIN_LOCATION)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df2021<span class="sc">$</span>END_LOCATION)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(df2021<span class="sc">$</span>END_LOCATION)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">substr</span>(df2021<span class="sc">$</span>BEGIN_DATE_TIME, <span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">substr</span>(df2021<span class="sc">$</span>END_DATE_TIME, <span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(df2021<span class="sc">$</span>BEGIN_DATE_TIME, <span class="at">format=</span><span class="st">"%d-%b-%y"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(df2021<span class="sc">$</span>END_DATE_TIME, <span class="at">format=</span><span class="st">"%d-%b-%y"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">format</span>(df2021<span class="sc">$</span>BEGIN_DATE_TIME, <span class="st">"%Y/%m/%d"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_DATE_TIME <span class="ot">&lt;-</span> <span class="fu">format</span>(df2021<span class="sc">$</span>END_DATE_TIME, <span class="st">"%Y/%m/%d"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>BEGIN_DATE_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(df2021<span class="sc">$</span>BEGIN_DATE_TIME, <span class="at">format =</span> <span class="st">"%Y/%m/%d"</span>), <span class="st">"%B"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>END_DATE_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(df2021<span class="sc">$</span>END_DATE_TIME, <span class="at">format =</span> <span class="st">"%Y/%m/%d"</span>), <span class="st">"%B"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>Duration_Days <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">difftime</span>(<span class="fu">as.Date</span>(df2021<span class="sc">$</span>END_DATE_TIME, <span class="at">format =</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"%Y/%m/%d"</span>),<span class="fu">as.Date</span>(df2021<span class="sc">$</span>BEGIN_DATE_TIME, <span class="at">format =</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">"%Y/%m/%d"</span>), <span class="at">units =</span> <span class="st">"days"</span>))</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>DAMAGE_PROPERTY <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"K"</span>, <span class="st">""</span>, df2021<span class="sc">$</span>DAMAGE_PROPERTY, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>df2021<span class="sc">$</span>DAMAGE_CROPS <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"K"</span>, <span class="st">""</span>, df2021<span class="sc">$</span>DAMAGE_CROPS, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2021)[<span class="fu">names</span>(df2021) <span class="sc">==</span> <span class="st">"DAMAGE_PROPERTY"</span>] <span class="ot">&lt;-</span> <span class="st">"DAMAGE_PROPERTY(K)"</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2021)[<span class="fu">names</span>(df2021) <span class="sc">==</span> <span class="st">"DAMAGE_CROPS"</span>] <span class="ot">&lt;-</span> <span class="st">"DAMAGE_CROPS(K)"</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df2021, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetails_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fatalities_df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_fatalities-ftp_v1.0_d2021_c20231017.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fatalities_df2021 <span class="ot">&lt;-</span> fatalities_df2021 <span class="sc">%&gt;%</span> <span class="fu">select</span>(FATALITY_ID, EVENT_ID, FATALITY_DATE, FATALITY_AGE, FATALITY_SEX, FATALITY_LOCATION)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fatalities_df2021<span class="sc">$</span>FATALITY_DATE <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(fatalities_df2021<span class="sc">$</span>FATALITY_DATE, <span class="at">format=</span><span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fatalities_df2021<span class="sc">$</span>FATALITY_MONTH <span class="ot">&lt;-</span> <span class="fu">format</span>(fatalities_df2021<span class="sc">$</span>FATALITY_DATE, <span class="st">"%B"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fatalities_df2021<span class="sc">$</span>FATALITY_AGE[<span class="fu">is.na</span>(fatalities_df2021<span class="sc">$</span>FATALITY_AGE)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fatalities_df2021<span class="sc">$</span>FATALITY_SEX[<span class="fu">is.na</span>(fatalities_df2021<span class="sc">$</span>FATALITY_SEX)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(fatalities_df2021, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormFatalities_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>locations_df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/StormEvents_locations-ftp_v1.0_d2021_c20231017.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>locations_df2021 <span class="ot">&lt;-</span> locations_df2021 <span class="sc">%&gt;%</span> <span class="fu">select</span>(EVENT_ID, LOCATION, LATITUDE, LONGITUDE)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>locations_df2021<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(.*?</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, locations_df2021<span class="sc">$</span>LOCATION) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>locations_df2021<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> <span class="fu">tolower</span>(locations_df2021<span class="sc">$</span>LOCATION) </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>locations_df2021<span class="sc">$</span>LOCATION <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(locations_df2021<span class="sc">$</span>LOCATION) </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(locations_df2021, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormLocations_clean.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>details_df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetails_clean.csv"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fatalities_df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormFatalities_clean.csv"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>locations_df2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormLocations_clean.csv"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the data frames</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>detailsfatalities_df2021 <span class="ot">&lt;-</span> details_df2021 <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fatalities_df2021, <span class="at">by =</span> <span class="st">"EVENT_ID"</span>) </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>detailslocations_df2021 <span class="ot">&lt;-</span> details_df2021 <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(locations_df2021, <span class="at">by =</span> <span class="st">"EVENT_ID"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>detailsfatalities_df2021  <span class="ot">&lt;-</span> detailsfatalities_df2021  <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR, <span class="fu">everything</span>())</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>detailslocations_df2021  <span class="ot">&lt;-</span> detailslocations_df2021  <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR, <span class="fu">everything</span>())</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(detailsfatalities_df2021, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetail+Fatalities.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(detailslocations_df2021, <span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetail+Locations.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="open-fema-datasets-1" class="level2">
<h2 class="anchored" data-anchor-id="open-fema-datasets-1">3. <strong>Open FEMA Datasets</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Disaster <span class="ot">&lt;-</span>  <span class="fu">read.csv</span>(<span class="st">'OpenFEMA Dataset/DisasterDeclarationsSummaries.csv'</span>,<span class="at">header =</span> T)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ApprovedNum <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"OpenFEMA Dataset/FemaWebDisasterSummaries.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Disaster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  femaDeclarationString disasterNumber state declarationType
1            FM-5389-AZ           5389    AZ              FM
2            FM-5389-AZ           5389    AZ              FM
3            FM-5464-RI           5464    RI              FM
4            FM-5463-KS           5463    KS              FM
5            FM-5462-NE           5462    NE              FM
6            DR-4731-CO           4731    CO              DR
           declarationDate fyDeclared incidentType
1 2021-06-06T00:00:00.000Z       2021         Fire
2 2021-06-06T00:00:00.000Z       2021         Fire
3 2023-04-14T00:00:00.000Z       2023         Fire
4 2023-04-13T00:00:00.000Z       2023         Fire
5 2023-04-09T00:00:00.000Z       2023         Fire
6 2023-08-25T00:00:00.000Z       2023        Flood
                        declarationTitle ihProgramDeclared iaProgramDeclared
1                         TELEGRAPH FIRE                 0                 0
2                         TELEGRAPH FIRE                 0                 0
3                      QUEENS RIVER FIRE                 0                 0
4                            HADDAM FIRE                 0                 0
5       WACONDA-BEAVER LAKE FIRE COMPLEX                 0                 0
6 SEVERE STORMS, FLOODING, AND TORNADOES                 0                 0
  paProgramDeclared hmProgramDeclared        incidentBeginDate
1                 1                 1 2021-06-06T00:00:00.000Z
2                 1                 1 2021-06-06T00:00:00.000Z
3                 1                 1 2023-04-14T00:00:00.000Z
4                 1                 1 2023-04-13T00:00:00.000Z
5                 1                 1 2023-04-08T00:00:00.000Z
6                 1                 1 2023-06-08T00:00:00.000Z
           incidentEndDate     disasterCloseoutDate tribalRequest fipsStateCode
1                          2023-09-29T00:00:00.000Z             0             4
2                          2023-09-29T00:00:00.000Z             0             4
3 2023-04-16T00:00:00.000Z                                      0            44
4 2023-04-16T00:00:00.000Z                                      0            20
5                                                               0            31
6 2023-06-23T00:00:00.000Z                                      0             8
  fipsCountyCode placeCode                           designatedArea
1              7     99007                            Gila (County)
2             21     99021                           Pinal (County)
3              9     99009 Washington (County)(in (P)MSA 5520,6480)
4            201     99201                      Washington (County)
5             25     99025                            Cass (County)
6              9     99009                            Baca (County)
  declarationRequestNumber lastIAFilingDate              lastRefresh
1                    21041                  2023-09-29T21:02:14.142Z
2                    21041                  2023-09-29T21:02:14.142Z
3                    23042                  2023-05-22T03:41:22.800Z
4                    23038                  2023-05-22T03:41:22.800Z
5                    23036                  2023-05-22T03:41:22.800Z
6                    23081                  2023-10-02T19:21:20.859Z
                                      hash                                   id
1 14b4a2c314124cae33e8ec790782a12c2af10a4c 226d44a3-418a-4102-9a55-385ea6599b2a
2 971d2204fdd213515f78a8575ca6fb14e66ca6fb 7304770a-6040-4bb2-b515-a50ffccefa40
3 1111d4d4a33f8a6e4d383ac5bd0e60b9bf142da0 9b9a9d9c-8b03-4049-9b16-a3c0d581556c
4 78dd55a181f146622eb65835b5d794689d1ea7f2 57d936ce-a0d7-412a-9d78-18aee530c146
5 5b35b5912f606a21ff29194317052ac7c2541be8 69325b2c-77cf-493f-8f1a-d5b5a737edf8
6 44d903d3d79b5295f58aefdd35682a8d3011644d fe1befa2-d7ac-4400-b430-36bf30ac9a15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ApprovedNum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  disasterNumber totalNumberIaApproved totalAmountIhpApproved
1           3601                    NA                     NA
2           3602                    NA                     NA
3           1239                    NA                     NA
4           1257                    NA                     NA
5           1260                    NA                     NA
6           1261                    NA                     NA
  totalAmountHaApproved totalAmountOnaApproved totalObligatedAmountPa
1                    NA                     NA                     NA
2                    NA                     NA                     NA
3                    NA                     NA                8225379
4                    NA                     NA               33279674
5                    NA                     NA                9863594
6                    NA                     NA                5735788
  totalObligatedAmountCatAb totalObligatedAmountCatC2g               paLoadDate
1                        NA                         NA                         
2                        NA                         NA                         
3                   4219882                    3961714 2023-11-06T00:00:00.000Z
4                   9756691                   23183629 2023-11-06T00:00:00.000Z
5                   3896686                    5833056 2023-11-06T00:00:00.000Z
6                   2349947                    3385841 2023-11-06T00:00:00.000Z
  iaLoadDate totalObligatedAmountHmgp                                     hash
1                                  NA 3de68baba960e69da445cf822d3dd859081fb34a
2                                  NA 58566c446fce5cabbd0c3412a6bb3daa4ada1993
3                             3887494 ca537b52814322d160d9170e47aa76a7436509a5
4                            18906913 b30f36f5a1d7e5a2cb2b13bd6e0541e22289aa79
5                             1875688 2eba8a1e7242ab520492ee925304cecc055f0bef
6                             1096729 90d4aa7f464ae0210638aa9c649f8c5fe1892252
               lastRefresh                                   id
1 2023-10-09T23:02:26.341Z faafecca-0f76-4fb8-8ffd-b6f46f3b712c
2 2023-10-09T23:02:26.341Z b74f0dc2-fab5-42b9-acf7-c94df14d85ad
3 2023-11-06T04:42:49.773Z fbadbc68-1994-4887-99c0-5bde4c871699
4 2023-11-06T04:42:49.773Z ddf55646-8caf-43f9-8848-768bc6f075d6
5 2023-11-06T04:42:49.773Z 3de1038d-284d-474a-a3cd-5e630878e56b
6 2023-11-06T04:42:49.773Z 8bb364fb-e866-446b-a8f9-6593a4ed868c</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Disaster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "femaDeclarationString"    "disasterNumber"          
 [3] "state"                    "declarationType"         
 [5] "declarationDate"          "fyDeclared"              
 [7] "incidentType"             "declarationTitle"        
 [9] "ihProgramDeclared"        "iaProgramDeclared"       
[11] "paProgramDeclared"        "hmProgramDeclared"       
[13] "incidentBeginDate"        "incidentEndDate"         
[15] "disasterCloseoutDate"     "tribalRequest"           
[17] "fipsStateCode"            "fipsCountyCode"          
[19] "placeCode"                "designatedArea"          
[21] "declarationRequestNumber" "lastIAFilingDate"        
[23] "lastRefresh"              "hash"                    
[25] "id"                      </code></pre>
</div>
</div>
<p>There are 25 variables in the data.frame Disaster. Of particular interest for this analysis is the response variable, disaster duration which is to be calculated from the difference between the <code>declarationDate</code> and <code>disasterCloseOutDate</code> features (numerical variable). The relationship between disaster duration and explanatory variables suh as the disaster types, program declared and geographic location will be explored. FEMA disaster records are historical observational data points, and as such will not establish causal links between disaster durations and other data features. However, this analysis will reveal insightful relationships between the variables. The data set is comprehensive and ecompasses all declared disasters (save for 214 that were filtered earlier). However, the estimates made in this analysis should not be generalized to all future disaster declarations as the there may be changes in FEMA disaster management or data collection protocals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading the CSV file</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ApprovedNum <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"OpenFEMA Dataset/FemaWebDisasterSummaries.csv"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting the specified columns</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ApprovedNum <span class="ot">&lt;-</span> ApprovedNum <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(disasterNumber, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         totalNumberIaApproved, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         totalAmountIhpApproved, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         totalAmountHaApproved, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         totalAmountOnaApproved, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>         totalObligatedAmountPa, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>         totalObligatedAmountCatAb, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>         totalObligatedAmountCatC2g, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         totalObligatedAmountHmgp)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing the new dataframe to a CSV file</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(ApprovedNum, <span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterAssistance.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the lastIAFilingDate, lastRefresh, hash, id columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Disaster <span class="ot">&lt;-</span> Disaster <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(lastIAFilingDate, lastRefresh, hash, id))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'declarationTitle' to lowercase</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Disaster<span class="sc">$</span>declarationTitle <span class="ot">&lt;-</span> <span class="fu">tolower</span>(Disaster<span class="sc">$</span>declarationTitle)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NA in 'incidentEndDate' and 'disasterCloseoutDate' for missing values</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Disaster<span class="sc">$</span>incidentEndDate <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(Disaster<span class="sc">$</span>incidentEndDate), </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span>, Disaster<span class="sc">$</span>incidentEndDate)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>Disaster<span class="sc">$</span>disasterCloseoutDate <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(Disaster<span class="sc">$</span>disasterCloseoutDate), </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span>, Disaster<span class="sc">$</span>disasterCloseoutDate)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Format date columns</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>date_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"declarationDate"</span>, <span class="st">"incidentBeginDate"</span>, <span class="st">"incidentEndDate"</span>, <span class="st">"disasterCloseoutDate"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>date_columns <span class="ot">&lt;-</span> date_columns[date_columns <span class="sc">%in%</span> <span class="fu">names</span>(Disaster)]</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>Disaster[date_columns] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Disaster[date_columns], <span class="cf">function</span>(x) {</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  formatted_date <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="cn">NA</span>, <span class="fu">substr</span>(x, <span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.Date</span>(formatted_date, <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the date format to "YYYY/MM/DD"</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>Disaster[date_columns] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  Disaster[date_columns], </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(x, <span class="st">"%Y/%m/%d"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract month from 'declarationDate' and convert to English month names</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Disaster<span class="sc">$</span>new_month <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(Disaster<span class="sc">$</span>declarationDate), <span class="st">"%B"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating Time Intervals and Duration Features.They represent time intervals between the declaration and close-out dates of the disaster, and between the beginning and end dates of the incident, respectively.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Disaster <span class="ot">&lt;-</span> Disaster <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">int_declaration =</span> <span class="fu">as.duration</span>(<span class="fu">interval</span>(declarationDate, disasterCloseoutDate)),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">int_incident =</span> <span class="fu">as.duration</span>(<span class="fu">interval</span>(incidentBeginDate, incidentEndDate)),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">declarationDur_secs =</span> <span class="fu">as.numeric</span>(int_declaration, <span class="st">"secs"</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">incidentDur_secs =</span> <span class="fu">as.numeric</span>(int_incident, <span class="st">"secs"</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">declarationDays =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(disasterCloseoutDate, declarationDate, <span class="at">units =</span> <span class="st">"days"</span>)), <span class="dv">1</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">incidentDays =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(incidentEndDate, incidentBeginDate, <span class="at">units =</span> <span class="st">"days"</span>)), <span class="dv">1</span>))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Disaster,<span class="st">"~/Desktop/MA615_Midterm-Project/OpenFEMA Dataset/Disaster_clean/DisasterDeclarations.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># declarationDate -&gt; Date format</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>disaster_declarations <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterDeclarations.csv"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>disaster_declarations<span class="sc">$</span>declarationDate <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(disaster_declarations<span class="sc">$</span>declarationDate, <span class="at">format=</span><span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting Year and Month</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>disaster_declarations<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(disaster_declarations<span class="sc">$</span>declarationDate, <span class="st">"%Y"</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>disaster_declarations<span class="sc">$</span>Month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(disaster_declarations<span class="sc">$</span>declarationDate, <span class="st">"%m"</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>state_data <span class="ot">&lt;-</span> disaster_declarations <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, declarationDate, Year, Month, disasterNumber, incidentType) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(disasterNumber, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="eda-conclusions" class="level1">
<h1><strong>EDA &amp; Conclusions</strong></h1>
<section id="analyzing-types-of-events-are-more-harmful-to-population-and-economics" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-types-of-events-are-more-harmful-to-population-and-economics">1. Analyzing types of events are more harmful to population and Economics</h2>
<p>Based on the NOAA Storm Events Database, this extended analysis aims to identify key disaster events between 2020 and 2021 that had significant impacts on population numbers and economic stability. A major finding from this study is the critical importance and inherent value in researching flood events.</p>
<p>It’s crucial to note that the focus of this analysis, particularly in terms of population, was predominantly on fatalities. This emphasis inadvertently led to a lesser consideration of injury counts. Additionally, the economic losses are analyzed from two perspectives: damage to property and damage to crops.</p>
</section>
<section id="populationhow-dangerous-are-floods" class="level2">
<h2 class="anchored" data-anchor-id="populationhow-dangerous-are-floods">1.1 Population(How dangerous are floods?)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>process_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, year) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_path)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>EVENT_TYPE <span class="ot">&lt;-</span> <span class="fu">as.character</span>(data<span class="sc">$</span>EVENT_TYPE)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>EVENT_TYPE[data<span class="sc">$</span>EVENT_TYPE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Coastal Flood"</span>, <span class="st">"Flash Flood"</span>, <span class="st">"Flood"</span>, <span class="st">"Lakeshore Flood"</span>)] <span class="ot">&lt;-</span> <span class="st">"Combined Flood"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data[<span class="sc">!</span><span class="fu">is.na</span>(data<span class="sc">$</span>FATALITY_ID), ]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  fatality_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(EVENT_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Fatality_Count =</span> <span class="fu">n_distinct</span>(FATALITY_ID))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  total_fatalities <span class="ot">&lt;-</span> <span class="fu">sum</span>(fatality_counts<span class="sc">$</span>Fatality_Count)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  fatality_data <span class="ot">&lt;-</span> fatality_counts <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Fatality_Percentage =</span> (Fatality_Count <span class="sc">/</span> total_fatalities) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">Year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Fatality_Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">10</span>, Fatality_Percentage) </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fatality_data)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>data_2020 <span class="ot">&lt;-</span> <span class="fu">process_data</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetail+Fatalities.csv"</span>, <span class="dv">2020</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Process data for 2021</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>data_2021 <span class="ot">&lt;-</span> <span class="fu">process_data</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetail+Fatalities.csv"</span>, <span class="dv">2021</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_2020, data_2021)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>ggplot_object <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(EVENT_TYPE, Fatality_Percentage), <span class="at">y =</span> Fatality_Percentage, <span class="at">size =</span> Fatality_Percentage)) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> EVENT_TYPE, <span class="at">shape =</span> <span class="fu">as.factor</span>(Year)), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Fatality_Percentage)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>)) <span class="sc">+</span>  </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span>  </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Fatal Events in 2020 and 2021 by Percentage"</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Event Type"</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Total Fatalities"</span>) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ggplot_object)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>This chart presents the percentages of fatalities for ten types of fatal natural disasters in the years 2020 and 2021. The conclusions drawn are as follows:</p>
<ol type="1">
<li><p><strong>Excessive Heat poses the highest danger</strong>: During these two years, the percentage of fatalities due to Excessive Heat was the highest, at 25.4% in 2020, with a slight decrease to 23.2% in 2021.</p></li>
<li><p><strong>High fatalities also from heat</strong>: Excessive Heat accounted for 13.8% in 2020 and increases to 15.2% in 2021, indicating that extreme temperatures are a significant cause of death.</p></li>
<li><p><strong>Significant risk of flooding</strong>: “Combined Flood” is represented as a separate category, indicating a combination of different types of flooding events. Combined flooding accounted for 6.7% and 12% of fatal events in 2020 and 2021, respectively, making it the third leading cause of death. This highlights the lethal nature of floods, which, although less percentage-wise compared to Excessive Heat, still represent a significant cause of fatalities. Floods are particularly dangerous due to their often sudden onset, the potential to affect large areas rapidly, and the resulting human casualties, economic losses, and infrastructure damage.</p></li>
</ol>
<p>The chart underscores the threat that various natural disasters pose to human life, especially highlighting the need for focused prevention and response measures for the risks associated with floods and extreme temperatures.</p>
</section>
<section id="economics-how-expensive-are-floods" class="level2">
<h2 class="anchored" data-anchor-id="economics-how-expensive-are-floods">1.2 Economics (How expensive are floods?)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2020/2020StormDetails_clean.csv"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data_2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NOAA Storm Events Dataset/Dataset_Clean_2021/2021StormDetails_clean.csv"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>data_2020<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>data_2021<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="dv">2021</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_2020, data_2021)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>data_combined<span class="sc">$</span>EVENT_TYPE <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_combined<span class="sc">$</span>EVENT_TYPE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Coastal Flood"</span>, <span class="st">"Flash Flood"</span>, <span class="st">"Flood"</span>, <span class="st">"Lakeshore Flood"</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Combined Flood"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                    data_combined<span class="sc">$</span>EVENT_TYPE)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>damage_summary_by_year <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, EVENT_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Property_Damage =</span> <span class="fu">sum</span>(DAMAGE_PROPERTY.K., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Crops_Damage =</span> <span class="fu">sum</span>(DAMAGE_CROPS.K., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span> </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>top_damage_property <span class="ot">&lt;-</span> damage_summary_by_year <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year, <span class="fu">desc</span>(Total_Property_Damage)) <span class="sc">%&gt;%</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>top_damage_crops <span class="ot">&lt;-</span> damage_summary_by_year <span class="sc">%&gt;%</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year, <span class="fu">desc</span>(Total_Crops_Damage)) <span class="sc">%&gt;%</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>top_damage_property <span class="ot">&lt;-</span> top_damage_property <span class="sc">%&gt;%</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year, <span class="fu">desc</span>(Total_Property_Damage))</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_damage_property, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(EVENT_TYPE, <span class="sc">-</span>Total_Property_Damage), <span class="at">y =</span> Total_Property_Damage, <span class="at">group =</span> Year, <span class="at">color =</span> <span class="fu">as.factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Total_Property_Damage), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Event Types by Property Damage (2020 vs 2021)"</span>, <span class="at">x =</span> <span class="st">"Event Type"</span>, <span class="at">y =</span> <span class="st">"Total Property Damage (K)"</span>) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="864"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_damage_crops, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(EVENT_TYPE, <span class="sc">-</span>Total_Crops_Damage), <span class="at">y =</span> Total_Crops_Damage, <span class="at">group =</span> Year, <span class="at">color =</span> <span class="fu">as.factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Total_Crops_Damage), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Event Types by Crops Damage (2020 vs 2021)"</span>, <span class="at">x =</span> <span class="st">"Event Type"</span>, <span class="at">y =</span> <span class="st">"Total Crops Damage (K)"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>This detailed chart provides an in-depth look at the top ten disaster events that caused the highest levels of property and crop damage in the years 2020-2021. A standout observation from this data is the extreme impact of Drought, which emerged as the leading cause of crop losses during this period.</p>
<p>In terms of property damage, Combined Floods were identified as the second most destructive event in this two-year span. These floods, encompassing various flood types such as flash floods, coastal floods, and river floods, collectively caused considerable. In 2020, the property damages from these floods were recorded at approximately $63,676K. This figure saw a notable increase in 2021, climbing to around $113,485K, indicating a worsening trend in flood-related damages.</p>
<p>Interestingly, while Combined Floods ranked second in property damage, they were also significant contributors to crop losses, ranking third in this category. This indicates the widespread impact of these floods, affecting not only physical structures and urban settings but also penetrating agricultural areas.</p>
</section>
<section id="analyzing-patterns-of-flood-losses-in-different-states" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-patterns-of-flood-losses-in-different-states">2. Analyzing patterns of flood losses in different states</h2>
<section id="top-10-worst-flood-affected-states-by-property" class="level3">
<h3 class="anchored" data-anchor-id="top-10-worst-flood-affected-states-by-property"><strong>2.1 Top 10 worst flood affected states by property</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  data_2020 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Flood"</span>, EVENT_TYPE)),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  data_2021 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Flood"</span>, EVENT_TYPE))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, STATE) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Damage =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">DAMAGE_PROPERTY.K.</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Damage)) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(STATE, Total_Damage), <span class="at">y =</span> Total_Damage, <span class="at">fill =</span> STATE)) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Total_Damage), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Year) <span class="sc">+</span>  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Worst Flood Affected States by 2020-2021"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"State"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Property Damage (in K $)"</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The bar chart offers a detailed visual representation of the Top10 flood-related property damages across different states in U.S. The data is quantified in thousands of dollars (K $), providing a clear comparison of the financial impact of flooding in these regions.</p>
<p>In 2020, North Carolina emerged as the most severely impacted state, with property damages totaling $8,444K. The chart also shows varying degrees of impact across other states, with West Virginia recording the least damage at $2,421K. This comparatively lower figure in West Virginia might be attributed to lesser flood severity, effective flood management systems, or a combination of both.</p>
<p>The scenario changed in 2021, where Tennessee was identified as the least affected state with damages amounting to $3,865K. This amount, though the lowest in 2021, was still higher than the least affected state in 2020. On the other end of the spectrum, New York experienced the highest property damage in 2021, with a figure that significantly surpassed those of other states. This could indicate an extraordinary flooding event or a lack of adequate flood defenses in the state.</p>
<p>Interestingly, some bars on the chart lack numerical data. This absence of numbers could imply that the NOAA (National Oceanic and Atmospheric Administration) might not have provided, or had access to, complete data for certain states for the years 2020-2021.</p>
</section>
<section id="how-different-climatic-conditions-have-influenced-flood-occurrences-in-the-u.s." class="level3">
<h3 class="anchored" data-anchor-id="how-different-climatic-conditions-have-influenced-flood-occurrences-in-the-u.s.">2.2 How different climatic conditions have influenced flood occurrences in the U.S.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_2020_clean <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_2020, FLOOD_CAUSE <span class="sc">!=</span> <span class="st">""</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data_2021_clean <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_2021, FLOOD_CAUSE <span class="sc">!=</span> <span class="st">""</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>flood_2020 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_2020_clean, <span class="fu">grepl</span>(<span class="st">"Flood"</span>, EVENT_TYPE, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>flood_2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_2021_clean, <span class="fu">grepl</span>(<span class="st">"Flood"</span>, EVENT_TYPE, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>flood_causes_2020 <span class="ot">&lt;-</span> <span class="fu">table</span>(flood_2020<span class="sc">$</span>FLOOD_CAUSE)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>flood_causes_2021 <span class="ot">&lt;-</span> <span class="fu">table</span>(flood_2021<span class="sc">$</span>FLOOD_CAUSE)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>blue_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"lightblue"</span>))</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plot_flood_causes <span class="ot">&lt;-</span> <span class="cf">function</span>(flood_causes, year) {</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  flood_causes_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(flood_causes)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(flood_causes_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"FLOOD_CAUSE"</span>, <span class="st">"Count"</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">blue_palette</span>(<span class="fu">length</span>(flood_causes_df<span class="sc">$</span>FLOOD_CAUSE))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(flood_causes_df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>Count, <span class="at">fill=</span>FLOOD_CAUSE)) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">width=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colors) <span class="sc">+</span> <span class="co"># Use the defined blue color palette</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Flood Causes in"</span>, year),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Flood Cause"</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>plot_2020 <span class="ot">&lt;-</span> <span class="fu">plot_flood_causes</span>(flood_causes_2020, <span class="st">"2020"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>plot_2021 <span class="ot">&lt;-</span> <span class="fu">plot_flood_causes</span>(flood_causes_2021, <span class="st">"2021"</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>plot_2020</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="1248"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_2021</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="1248"></p>
</div>
</div>
<p>The two pie charts show the distribution of flood causes in 2020 and 2021. We can view which cause affected most of the time in different years (only year 2020 and year 2021).</p>
<p>The majority of floods in U.S. are caused by Heavy Rain. On the other hand, Snow Melt and Tropical System also affect and cause the floods in U.S.</p>
<p>View different states affected by flood maximum number of days or duration by different flood causes, so that states with large number of days can be put in risk.</p>
</section>
<section id="analyzing-frequency-of-flood-disasters-in-each-state-in-u.s" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-frequency-of-flood-disasters-in-each-state-in-u.s"><strong>2.3</strong> Analyzing frequency of flood disasters in each state in U.S</h3>
<p>Conduct a study on the geographical distribution of flood occurrence frequency across the U.S. to determine the specific number of floods in each state. In the visual map, different shades of color are used to intuitively represent the frequency of flooding, where darker colors indicate higher frequencies of floods in those areas. We can observe significant differences in flood occurrence frequencies across different regions of the U.S. Based on this geographical analysis, governments and relevant agencies can more effectively allocate relief materials and resources to disaster-prone areas, thereby avoiding resource waste and achieving more targeted disaster prevention and response.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>disaster_assistance <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterAssistance.csv"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>disaster_declarations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterDeclarations.csv"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging the data based on 'disasterNumber'</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(disaster_declarations, disaster_assistance, <span class="at">by =</span> <span class="st">"disasterNumber"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing the merged dataframe to a new CSV file</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(merged_data, <span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterTotal.csv"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"OpenFEMA Dataset/Disaster_clean/DisasterDeclarations.csv"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a mapping from state abbreviations to full names</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">state_abbrev =</span> state.abb, <span class="at">state_full =</span> state.name)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Data processing, filter out flood events and calculate the occurrence frequency for each state</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>flood_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(incidentType <span class="sc">==</span> <span class="st">"Flood"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>flood_counts_full <span class="ot">&lt;-</span> <span class="fu">merge</span>(flood_counts, state_names, <span class="at">by.x =</span> <span class="st">"state"</span>, <span class="at">by.y =</span> <span class="st">"state_abbrev"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"flood_counts_full"</span>)) {</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The 'flood_counts_full' dataset does not exist in the current environment."</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"state"</span> <span class="sc">%in%</span> <span class="fu">names</span>(flood_counts_full) <span class="sc">&amp;&amp;</span> <span class="st">"count"</span> <span class="sc">%in%</span> <span class="fu">names</span>(flood_counts_full))) {</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The 'flood_counts_full' dataset must contain 'state' and 'count' columns."</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot_usmap</span>(<span class="at">data =</span> flood_counts_full, <span class="at">values =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>, <span class="at">name =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Flood Incidents by State in U.S."</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Count"</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plot_top10_flood_states <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"flood_counts_full"</span>)) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The 'flood_counts_full' dataset does not exist in the current environment."</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  top_states <span class="ot">&lt;-</span> flood_counts_full <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(top_states, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(state, count), <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flips the axes for better readability</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Top 10 States with Most Flood Events"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"State"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Number of Flood Events"</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_top10_flood_states</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see from charts that flood disasters are primarily concentrated around the Great Lakes region in the North, as seen by the Northern states being the most affected, with over 600 flooding incidents occurring.</p>
</section>
<section id="correlation-between-flood-incidents-and-disaster-declaration-durations-in-u.s." class="level3">
<h3 class="anchored" data-anchor-id="correlation-between-flood-incidents-and-disaster-declaration-durations-in-u.s.">2.4 Correlation between flood incidents and disaster declaration durations in U.S.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>groupedByEvent <span class="ot">&lt;-</span> disaster_declarations <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disasterNumber, incidentType, incidentBeginDate, declarationDays, incidentDays ) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">countiesInvolved =</span> <span class="fu">n</span>(),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">statesInvolved =</span> <span class="fu">n_distinct</span>( state ),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span> <span class="co"># Add this line to drop the grouping</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>( <span class="fu">desc</span>(declarationDays) )</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( groupedByEvent, <span class="dv">5</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  disasterNumber incidentType     incidentBeginDate declarationDays incidentDays
           &lt;dbl&gt; &lt;chr&gt;            &lt;date&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
1           3066 Toxic Substances 1978-08-07                  12107            0
2            792 Flood            1987-04-03                   8904            4
3            483 Flood            1975-09-19                   8699            0
4           1008 Earthquake       1994-01-17                   8656          317
5           3080 Toxic Substances 1980-05-21                   8274            0
# ℹ 2 more variables: countiesInvolved &lt;int&gt;, statesInvolved &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>filteredData <span class="ot">&lt;-</span> groupedByEvent <span class="sc">%&gt;%</span> <span class="fu">filter</span>(incidentType <span class="sc">==</span> <span class="st">"Flood"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filteredData, <span class="fu">aes</span>( <span class="at">x =</span> countiesInvolved, <span class="at">y =</span> declarationDays, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> incidentType )) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>( <span class="at">size =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Disaster Declaration Duration relationship with Number of Counties Involved"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>( <span class="st">"Disaster Declaration Duration (days)"</span> ) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>( <span class="st">"Counties"</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>( <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Midterm-Project_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the majority of the data points are concentrated in the bottom left corner of the chart, indicating that most flood events involve a smaller number of counties and are associated with shorter disaster declaration durations. There appears to be a trend of increasing disaster declaration duration with the number of counties involved, especially when fewer counties are affected. This information can be used to alert residents to take preventive measures early on.</p>
</section>
</section>
</section>
<section id="future-plan" class="level1">
<h1>Future Plan</h1>
<p>Floods are the most destructive form of natural hazards in both local and global context.This is true in terms of both loss of life and property damage. Early flood forecasting can be used to identify potential areas of flooding in order to develop mitigatory planning and evacuation programs to remove people from such areas during flooding and also to implement suitable preventive measures to avoid damage to properties.</p>
</section>
<section id="reference" class="level1">
<h1><strong>Reference</strong></h1>
<ol type="1">
<li><a href="https://www.fema.gov/openfema-data-page/mission-assignments-v1" class="uri">https://www.fema.gov/openfema-data-page/mission-assignments-v1</a></li>
<li><a href="https://www.ncdc.noaa.gov/stormevents/faq.jsp" class="uri">https://www.ncdc.noaa.gov/stormevents/faq.jsp</a></li>
<li><a href="https://www.fema.gov/about/openfema/faq" class="uri">https://www.fema.gov/about/openfema/faq</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4225791/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4225791/</a></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>